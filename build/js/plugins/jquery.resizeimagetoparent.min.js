! function(t) {
    t.fn.resizeToParent = function(e) {
        function i(t) {

        	var enlargeRatio = t.attr("enlargeRatio") || 1;  
            var alignTop = t.attr("align-top") || false;   

            t.css({
                width: "",
                height: "",
                "margin-left": "",
                "margin-top": ""
            });
            var i = (t.parents(e.parent).width() * enlargeRatio),
                n = (t.parents(e.parent).height() * enlargeRatio),
                a = t.attr("width") || t.width(),
                r = t.attr("height") || t.height(),
                h = a / i;
            n > r / h ? (t.css({
                width: "auto",
                height: n
            }), a /= r / n, r = n) : (t.css({
                height: "auto",
                width: i
            }), a = i, r /= h);
            var s = (a - i) / -2,
                o = calculateMarginTop(r,n, alignTop);
            t.css({
                "margin-left": s,
                "margin-top": o
            }), t.removeClass("cloaked");
        }
        var n, a = {
                parent: "div",
                delay: 100
            },
            e = t.extend(a, e),
            r = this;

        var calculateMarginTop = function(r,n, alignTop){
            
            if (alignTop){ 
                return 0;
            } else {
                return (r - n) / -2;
            }
        };

        return t(window).on("resize", function() {
            clearTimeout(n), n = setTimeout(function() {
                r.each(function() {
                    i(t(this))
                })
            }, e.delay)
        }), this.each(function() {
            var e = t(this);
            e.attr("src", e.attr("src")), e.load(function() {
                i(e)
            }), this.complete && i(e)
        })
    }
}(jQuery);